import pandas as pd
import matplotlib.pyplot as plt

# ============================
# 1) DataFrame with your data
# ============================
data = {
    'Real': [
        'E039','E039','2724','E039','4019','E785','E785','2724','E039','Z87891',
        '2724','E785','2724','4019','Z794','Z794','Z87891','2724','Z794','Z87891',
        'E785','E039','4019','E785','E039','2724','2724','Z87891','E785','Z794',
        '4019','E785','4019','Z794','E039','Z87891','4019','E039','Z87891','2724',
        '4019','4019','E785','4019','Z794','Z794','2724','Z794','E785','4019',
        'E039','4019','2724','E785','4019','Z87891','2724','E039','E785','E785',
        'Z794','4019','2724','Z794','Z87891','2724','2724','Z794','2724','2724',
        '4019','Z87891','2724','E785','Z87891','Z794','E039','E039','Z794','E039',
        'Z794','E785','Z87891','E785','Z794','E039','E039','E039','Z87891','E039',
        'E785','4019','Z87891','E039','E785','Z87891','4019','4019','Z87891','2724',
        'E039','4019','2724','4019','Z87891','Z794','Z794','Z87891','E785','Z794',
        'Z794','Z87891','4019','E785','E785','Z87891','2724','Z794','E039','Z87891'
    ],
    'Predicted': [
        'E039','E039','2724','E039','4019','E785','E785','2724','E039','Z87891',
        '2724','E785','2724','4019','Z794','Z794','Z87891','2724','Z794','Z87891',
        'E785','E039','4019','E785','E039','2724','2724','Z87891','E785','Z794',
        '4019','E785','4019','Z794','E039','Z87891','4019','E039','Z87891','2724',
        '4019','4019','E785','4019','Z794','Z794','2724','Z794','E785','4019',
        'E039','4019','2724','E785','4019','Z87891','2724','E039','E785','E785',
        'Z794','4019','2724','Z794','Z87891','2724','2724','Z794','2724','2724',
        '4019','Z87891','2724','E785','Z87891','Z794','E039','E039','Z794','E039',
        'Z794','E785','Z87891','E785','Z794','E039','E039','E039','Z87891','E039',
        'E785','4019','Z87891','E039','E785','Z87891','4019','4019','Z87891','2724',
        'E039','4019','2724','4019','Z87891','Z794','Z794','Z87891','E785','Z794',
        'Z794','Z87891','4019','E785','E785','Z87891','2724','Z794','E039','Z87891'
    ]
}

comparison = pd.DataFrame(data)

# ============================
# 2) Correct/Incorrect column
# ============================
comparison['Correct'] = comparison['Real'] == comparison['Predicted']

# ============================
# 3) Group by ICD code and calculate accuracy percentage
# ============================
accuracy_per_icd = comparison.groupby('Real')['Correct'].mean() * 100  # in %
accuracy_per_icd = accuracy_per_icd.sort_values(ascending=False)  # optional: sort from highest to lowest

# ============================
# 4) Plot the graph
# ============================
plt.figure(figsize=(10,6))
accuracy_per_icd.plot(kind='bar', color='#3498DB')
plt.ylabel('Accuracy Percentage (%)', fontsize=12)
plt.xlabel('ICD Code', fontsize=12)
plt.title('Accuracy Percentage per ICD Code', fontsize=14)
plt.ylim(0, 100)
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()
